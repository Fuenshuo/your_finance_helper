# 统一记账入口 - 交互原型设计

## 🎯 设计目标

**单一入口，AI自动识别，零认知负担**

用户只需一个动作："记一笔"，AI自动判断是收入、支出还是转账。

## ⚠️ 设计原则：从"工程思维"到"生活对话"

### 核心转变

| 工程思维 | 用户感知 | 优化方向 |
|--------|--------|--------|
| "系统需要确认类型" | "为什么还要我选？" | 默认最可能选项，一键覆盖 |
| "AI 置信度不足" | "它是不是不太靠谱？" | 隐藏不确定性，只问缺失信息 |
| "分类标准化" | "这些选项跟我没关系" | 用生活场景词替代财务术语 |
| "功能完整优先" | "好复杂，不想记了" | 极简主路径 + 渐进披露 |
| "识别错了" | "记错了" | 用生活化语言，不用技术术语 |

### 关键优化点

1. **反馈文案**：用肯定语气，隐藏AI的不确定性
2. **交互控件**：用场景化标签替代分类术语
3. **修正入口**：用"记错了"而非"识别错了"
4. **Placeholder引导**：用生活化问句激发自然表达

## 📱 核心交互流程

### 1. 主入口设计

```
┌─────────────────────────────────────┐
│  💰 总资产：¥XXX,XXX                 │
│  📊 本月收入：¥XX,XXX  💸 支出：¥X,XXX│
├─────────────────────────────────────┤
│                                     │
│  ┌─────────────────────────────┐   │
│  │  ➕ 刚发工资了？             │   │
│  │  (轮播问句，3秒切换)          │   │
│  └─────────────────────────────┘   │
│                                     │
│  [📷 拍照] [🎤 语音] [📋 粘贴]      │
│                                     │
│  [💰 记收入] [💸 记支出] [🔄 转账]  │
│  (⚠️ A/B测试：版本A显示，版本B隐藏)  │
└─────────────────────────────────────┘
```

**⚠️ 生活化优化**：
- **Placeholder 轮播问句**（3秒淡入淡出切换）：
  - "刚发工资了？"
  - "又买奶茶啦？"
  - "朋友转你钱了？"
  - "今天花了多少？"
- **优势**：
  - 更像朋友聊天，激发自然输入
  - 避免用户误以为必须按固定格式输入
  - 覆盖多种常见场景
- **动态 Placeholder**（可选，基于时间）：
  - 早上："今天有什么收入？"
  - 中午："午饭花了多少？"
  - 晚上："今天花了多少钱？"
- **统一输入框**：用生活场景问句替代模板
- **⚠️ 快速入口A/B测试**：
  - **版本A**：显示快速入口（供习惯明确分类的用户使用）
  - **版本B**：隐藏快速入口（仅统一输入框 + 多模态按钮）
  - **埋点观察**：使用快速入口的用户 vs 统一入口用户的留存差异
- **多模态入口**：拍照、语音、粘贴按钮
- **假设验证**：快速入口可能削弱统一入口的心智，让用户回到"分类思维"

---

### 2. 用户输入 → AI解析流程

#### 2.1 输入阶段

```
用户输入："工资12000"
    ↓
显示loading状态（<2s）
    ↓
[AI思考中...] 动画
```

**Loading设计**：
- 轻微脉冲动画
- 显示"正在理解..."（可选）
- 如果>2s，显示"AI正在处理，请稍候..."

---

#### 2.2 AI解析结果路由

根据置信度和类型，进入不同流程：

```
AI解析结果
    ├─ type: income, confidence ≥ 0.9 → [流程A：自动保存]
    ├─ type: income, 0.7 ≤ confidence < 0.9 → [流程B：快速确认]
    ├─ type: income, confidence < 0.7 → [流程C：降级补全]
    ├─ type: expense, confidence ≥ 0.9 → [流程A：自动保存]
    ├─ type: expense, 0.7 ≤ confidence < 0.9 → [流程B：快速确认]
    ├─ type: expense, confidence < 0.7 → [流程C：降级补全]
    └─ type: transfer → [流程D：转账确认]
```

---

## 🔄 详细交互流程

### 流程A：高置信度自动保存（≥90%）

#### A1: 收入自动保存（⚠️ 生活化、肯定语气）

```
用户输入："工资12000"
    ↓
AI解析：{type: income, category: salary, amount: 12000, confidence: 0.95}
    ↓
自动保存到Transaction
    ↓
┌─────────────────────────────────────┐
│  🎉 工资到账 ¥12,000！              │
│                                     │
│  (点击可修改)                        │
└─────────────────────────────────────┘
(Toast，2秒后自动消失，可点击)
    ↓
可选：显示预测提示
┌─────────────────────────────────────┐
│  💡 下次发工资时，我会自动提醒你确认  │
│                                     │
│  [知道了]                           │
└─────────────────────────────────────┘
(3秒后自动消失)
```

**⚠️ 生活化优化**：
- **肯定语气**：即使背后是85%置信度，也用肯定语气，隐藏AI的"犹豫"
- **积极表达**：收入用"🎉 到账"等积极词汇，强化正向反馈
- **自然修正入口**：
  - ❌ "[修正]"（技术感）
  - ✅ "(点击可修改 ↗️)"（生活化 + 动效提示）
- **⚠️ 动效提示**：
  - "(点击可修改)"文字末尾加 `↗️` 图标
  - 或让文字有轻微呼吸动画（0.5s循环）
  - 提示用户这是可交互区域
- **震动反馈**：轻微震动（iOS/Android）
- **Toast可点击**：点击后进入快速编辑页
- **预测提示**：仅收入类型显示，支出不显示

#### A2: 支出自动保存（⚠️ 中性、生活化语气）

```
用户输入："奶茶28"
    ↓
AI解析：{type: expense, category: food, amount: 28, confidence: 0.92}
    ↓
自动保存
    ↓
┌─────────────────────────────────────┐
│  ✅ 已记录：奶茶 ¥28                 │
│                                     │
│  (点击可修改)                        │
└─────────────────────────────────────┘
(Toast，2秒后自动消失)
```

**⚠️ 生活化优化**：
- **中性语气**：支出用"✅ 已记录"等中性词汇，避免负面情绪
- **场景化描述**：用"奶茶"而非"餐饮"，更贴近用户实际场景
- **自然修正入口**：
  - ❌ "[修正]"（技术感）
  - ✅ "(点击可修改)"（生活化）
- **心理学依据**：正向反馈强化用户记录收入的行为

---

### 流程B：中置信度快速确认（70-89%）

#### B1: 收入快速确认（⚠️ 生活化、场景化标签）

```
用户输入："奖金80000"
    ↓
AI解析：{type: income, category: bonus, amount: 80000, confidence: 0.85}
    ↓
底部弹出确认条（⚠️ 悬停不消失，或手动关闭）
┌─────────────────────────────────────┐
│  💰 刚收到 ¥80,000，这是什么收入？  │
│                                     │
│  [我的工资] [年终奖] [朋友转账] [其他]│
└─────────────────────────────────────┘
    ↓
用户点击任意选项 → 保存
```

**⚠️ 生活化优化**：
- **肯定语气**：用"刚收到"而非"看起来像"，隐藏AI的不确定性
- **场景化标签**：
  - ❌ "[是] [是奖金] [其他]"（像调参）
  - ✅ "[我的工资] [年终奖] [朋友转账] [其他]"（生活场景）
- **⚠️ 防误触优化（明确采纳方案B）**：
  - ✅ **方案B**：增加 [×] 关闭按钮，移除自动消失（推荐，更安全）
  - ❌ 方案A：手指/光标悬停在确认条上时暂停倒计时（不采用）
  - **理由**：金融类操作宁可多一步，也不能误触。自动消失在嘈杂环境（如地铁）极易导致用户没看清就消失，引发焦虑
- **点击任意选项**：立即保存，无需二次确认
- **"其他"选项**：跳转到降级补全流程
- **设计原则**：金融类操作宁可"慢一点"，也不能"错一步"

#### B2: 支出快速确认（⚠️ 生活化、场景化标签）

```
用户输入："打车50"
    ↓
AI解析：{type: expense, category: transport, amount: 50, confidence: 0.78}
    ↓
┌─────────────────────────────────────┐
│  💸 打车花了 ¥50？                 │
│                                     │
│  [打车] [吃饭] [购物] [其他]         │
└─────────────────────────────────────┘
```

**⚠️ 生活化优化**：
- **场景化描述**：用"打车"而非"交通"，更贴近用户实际场景
- **场景化标签**：
  - ❌ "[是] [是餐饮] [其他]"（像调参）
  - ✅ "[打车] [吃饭] [购物] [其他]"（生活场景）
- **肯定语气**：用"花了"而非"看起来像"，隐藏AI的不确定性

---

### 流程C：低置信度降级补全（<70%）

#### C1: 信息缺失（如"发钱了"）（⚠️ 生活化引导）

```
用户输入："发钱了"
    ↓
AI解析：{type: income, amount: null, confidence: 0.45, uncertainty: "用户说'发钱了'但未提金额"}
    ↓
极简补全界面（⚠️ 隐藏不确定性，只问缺失信息）
┌─────────────────────────────────────┐
│  💰 发工资啦！多少钱？               │
│                                     │
│  金额：¥ [______]                  │
│                                     │
│  类型：[我的工资 ▼]                 │
│     [我的工资] [年终奖] [朋友转账]   │
│                                     │
│  日期：今天（2025-01-20）          │
│                                     │
│  [快速填充] [工资12000] [年终奖80000]│
│  (基于用户历史动态生成)              │
│                                     │
│  [保存] [取消]                      │
└─────────────────────────────────────┘
```

**⚠️ 生活化优化**：
- **隐藏不确定性**：不暴露AI的"犹豫"，只问缺失信息
- **生活化标题**：
  - ❌ "请补充关键信息"（技术感）
  - ✅ "发工资啦！多少钱？"（生活化）
- **场景化标签**：
  - ❌ "[工资]"（分类术语）
  - ✅ "[我的工资] [年终奖] [朋友转账]"（生活场景）
- **金额必填**：AI未提取到金额时，金额输入框高亮
- **类型预填**：AI提取到的类型作为默认值
- **⚠️ 示例按钮动态生成**：
  - 基于 UserIncomeProfile 生成个性化示例
  - 如果用户常收 freelance → ["稿费5000", "外包8000"]
  - 如果用户常收 gift → ["红包200", "压岁钱1000"]
  - 如果用户常收 salary → ["工资12000", "月薪15000"]
- **日期预填**：AI提取或默认今天
- **优势**：让引导更个性化，提升首次成功记录率

#### C2: 信息模糊（如"一万二"）（⚠️ 生活化引导）

```
用户输入："一万二"
    ↓
AI解析：{type: null, amount: 12000, confidence: 0.55}
    ↓
┌─────────────────────────────────────┐
│  💰 这笔 ¥12,000 是什么？           │
│                                     │
│  金额：¥12,000 ✓                     │
│                                     │
│  类型：[请选择 ▼]                    │
│     [💰 收入] [💸 支出] [🔄 转账]    │
│                                     │
│  日期：今天（2025-01-20）          │
│                                     │
│  [保存] [取消]                      │
└─────────────────────────────────────┘
```

**⚠️ 生活化优化**：
- **生活化标题**：
  - ❌ "请告诉我这是什么？"（技术感）
  - ✅ "这笔 ¥12,000 是什么？"（生活化）
- **隐藏不确定性**：不暴露AI的"犹豫"，只问缺失信息

---

### 流程D：转账类型确认（⚠️ 强化方向选择）

#### D1: 转账识别（⚠️ 生活化、场景化表达 + 默认方向）

```
用户输入："转账5000"
    ↓
AI解析：{type: transfer, amount: 5000, confidence: 0.75}
    ↓
转账确认界面（⚠️ 生活化方向选项 + 默认选中）
┌─────────────────────────────────────┐
│  🔄 这笔 ¥5,000 是？                │
│                                     │
│  [✓ 我转给朋友] (默认选中)          │
│  [朋友转给我]                       │
│  [银行卡间转账]                     │
│                                     │
│  💡 银行卡转账不计入预算统计         │
└─────────────────────────────────────┘
```

**⚠️ 生活化优化**：
- **场景化表达**：
  - ❌ "[我转出（不计入支出）]"（技术感）
  - ✅ "[我转给朋友]"（生活场景）
- **⚠️ 默认方向（基于用户历史）**：
  - 如果用户历史中90%的转账是"银行卡间互转" → 默认选中 `[银行卡间转账]`
  - 如果用户常收朋友还款 → 默认选中 `[朋友转给我]`
  - 如果用户常转给朋友 → 默认选中 `[我转给朋友]`
  - **优势**：进一步减少点击，符合"默认最可能选项"原则
- **强化方向选择**：
  - "我转给朋友"：转给他人，不计入支出
  - "朋友转给我"：收到转账，算作收入（如朋友还款）
  - "银行卡间转账"：纯转账，不计入预算
- **明确提示**：银行卡转账不计入预算统计
- **覆盖真实场景**：用户可能想记录"收到转账"作为收入

---

## 🔧 错误恢复机制

### 1. Toast点击快速编辑（⚠️ 生活化表达）

```
用户点击Toast（已改为"点击可修改"）
    ↓
快速编辑页面
┌─────────────────────────────────────┐
│  ✏️ 改一下                           │
│                                     │
│  金额：¥ [12,000]                   │
│                                     │
│  类型：[我的工资 ▼]                 │
│     [我的工资] [年终奖] [朋友转账]   │
│                                     │
│  日期：[2025-01-20 ▼]              │
│                                     │
│  [保存] [删除] [取消]                │
└─────────────────────────────────────┘
```

**⚠️ 生活化优化**：
- **自然标题**：
  - ❌ "修正记录"（技术感）
  - ✅ "改一下"（生活化）
- **场景化标签**：
  - ❌ "[工资] [奖金] [兼职] [其他]"（分类术语）
  - ✅ "[我的工资] [年终奖] [朋友转账]"（生活场景）
- **极简编辑**：只显示关键字段
- **删除功能**：可删除错误记录
- **快速保存**：修改后立即保存

---

### 2. 最近记录快速编辑（⚠️ 优化入口避免手势冲突）

#### 2.1 入口：长按输入框（推荐）

```
用户长按输入框
    ↓
显示最近3笔记录
┌─────────────────────────────────────┐
│  📋 最近记录                         │
│                                     │
│  💰 工资收入 ¥12,000（1小时前）    │
│     [点击编辑]                       │
│                                     │
│  💸 餐饮支出 ¥28（2小时前）         │
│     [点击编辑]                       │
│                                     │
│  💰 奖金收入 ¥80,000（昨天）        │
│     [点击编辑]                       │
│                                     │
│  [查看更多]                          │
└─────────────────────────────────────┘
```

#### 2.1.1 入口：输入框下方固定显示（备选方案）

```
┌─────────────────────────────────────┐
│  ➕ 记一笔...                        │
├─────────────────────────────────────┤
│  📋 最近：工资收入 ¥12,000（1小时前）│
│     [点击编辑]                       │
└─────────────────────────────────────┘
```

**⚠️ 设计要点**：
- **避免手势冲突**：首页下滑可能触发 Pull-to-refresh
- **推荐方案**：长按输入框呼出（避免与下拉刷新冲突）
- **备选方案**：输入框下方固定显示最近1笔（无需手势）

#### 2.2 入口：长按记录

```
用户在交易列表长按某条记录
    ↓
弹出菜单
┌─────────────────────────────────────┐
│  [✏️ 编辑]                          │
│  [🗑️ 删除]                          │
│  [📋 复制]                          │
│  [取消]                             │
└─────────────────────────────────────┘
```

---

### 3. "识别错了？"一键修正

#### 3.1 在快速确认界面（⚠️ 生活化表达）

```
┌─────────────────────────────────────┐
│  💰 刚收到 ¥12,000，这是什么收入？  │
│                                     │
│  [我的工资] [年终奖] [朋友转账] [其他]│
│                                     │
│  [记错了？点这儿改]                 │
└─────────────────────────────────────┘
```

**⚠️ 生活化优化**：
- **自然修正入口**：
  - ❌ "[识别错了？] [修正]"（技术感）
  - ✅ "[记错了？点这儿改]"（生活化）

#### 3.2 在降级补全界面（⚠️ 生活化表达）

```
┌─────────────────────────────────────┐
│  💰 发工资啦！多少钱？               │
│                                     │
│  金额：¥12,000 ✓                    │
│                                     │
│  类型：[我的工资 ▼]                 │
│                                     │
│  [记错了？重新输入]                 │
└─────────────────────────────────────┘
```

**⚠️ 生活化优化**：
- **自然修正入口**：
  - ❌ "[识别错了？] [重新输入]"（技术感）
  - ✅ "[记错了？重新输入]"（生活化）

---

## 🚫 去重逻辑交互

### 模糊去重提示（⚠️ 生活化表达 + 明确合并行为）

```
用户输入："工资12000"
    ↓
检测到类似记录
    ↓
去重提示界面
┌─────────────────────────────────────┐
│  💡 今天已经记过一笔类似的：         │
│                                     │
│  💰 工资收入 ¥12,350（1小时前）     │
│                                     │
│  要再记一笔吗？                     │
│                                     │
│  [再记一笔]                         │
│  [合并到这条]                       │
│  [取消]                             │
└─────────────────────────────────────┘
```

**⚠️ 生活化优化**：
- **自然提示**：
  - ❌ "检测到今天已有类似记录"（技术感）
  - ✅ "今天已经记过一笔类似的"（生活化）
- **场景化选项**：
  - ❌ "[是，再记一笔] [合并到已有记录] [取消]"（技术感）
  - ✅ "[再记一笔] [合并到这条] [取消]"（生活化）
- **显示已有记录**：让用户看到相似记录
- **提供选项**：再记一笔、合并、取消
- **⚠️ 合并逻辑（明确行为，避免开发歧义）**：
  - **合并后金额** = 原金额 + 新金额
  - **备注自动添加**："+ 工资补录" 或 "+ ¥12,000"
  - **保留原记录时间**：不改变原记录的日期时间
  - **示例**：
    - 原记录：工资收入 ¥12,350（1小时前）
    - 新输入：工资收入 ¥12,000
    - 合并后：工资收入 ¥24,350，备注："+ ¥12,000"

---

## 📊 状态转换图

```
[输入框]
    ↓
[用户输入]
    ↓
[AI解析中...] (loading)
    ↓
┌─────────────────────────────────────┐
│  解析结果路由                         │
├─────────────────────────────────────┤
│  confidence ≥ 0.9                   │
│    → [自动保存] → [Toast反馈]        │
│       ↓                              │
│    [点击Toast] → [快速编辑]          │
├─────────────────────────────────────┤
│  0.7 ≤ confidence < 0.9             │
│    → [快速确认条] → [用户选择]        │
│       ↓                              │
│    [保存] 或 [修正] → [快速编辑]      │
├─────────────────────────────────────┤
│  confidence < 0.7                    │
│    → [降级补全] → [用户补充]         │
│       ↓                              │
│    [保存] 或 [重新输入]               │
├─────────────────────────────────────┤
│  type: transfer                      │
│    → [转账确认] → [用户确认]         │
│       ↓                              │
│    [保存]                             │
└─────────────────────────────────────┘
```

---

## 🎨 UI组件设计规范

### 1. 输入框

- **高度**：56dp（标准输入框）
- **圆角**：12dp
- **内边距**：16dp
- **字体**：16sp，常规
- **占位符**：14sp，灰色，提供示例

### 2. Toast反馈

- **位置**：顶部居中（不遮挡输入框）
- **背景**：半透明黑色（80%透明度）
- **圆角**：8dp
- **内边距**：16dp
- **动画**：从顶部滑入，2秒后淡出
- **可点击**：点击后进入快速编辑

### 3. 快速确认条

- **位置**：底部（不遮挡输入框）
- **背景**：卡片样式，白色
- **圆角**：顶部12dp
- **阴影**：轻微阴影
- **自动消失**：3秒后向上滑出

### 4. 降级补全界面

- **位置**：模态弹窗（居中）
- **背景**：白色卡片
- **圆角**：16dp
- **最大宽度**：90%屏幕宽度
- **输入框**：标准Material Design样式

---

## ✅ 验收标准

### MVP验收

- [ ] 用户输入"工资12000" → 自动识别为收入并保存
- [ ] 用户输入"奶茶28" → 自动识别为支出并保存
- [ ] 用户输入"转账5000" → 提示转账确认
- [ ] 识别错误可快速修正（Toast点击、最近记录编辑）
- [ ] 模糊输入（如"发钱了"）→ 引导用户补充信息
- [ ] 去重逻辑正常工作（提示相似记录）

### 交互流畅度

- [ ] AI解析延迟 <2s（显示loading）
- [ ] Toast反馈及时（<100ms）
- [ ] 快速编辑页面打开 <300ms
- [ ] 无卡顿、无闪烁

---

## 🔄 后续优化方向

1. **语音输入**：语音转文本后走文本流程
2. **图片识别**：工资条OCR、银行通知识别
3. **智能建议**：基于历史记录推荐分类
4. **批量录入**：支持一次输入多条记录
5. **快捷短语**：常用短语快速填充

---

**设计完成时间**：2025-01-20  
**设计版本**：v1.0 MVP  
**下一步**：与开发团队评审，细化技术实现细节

